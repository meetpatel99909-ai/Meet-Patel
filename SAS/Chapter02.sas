 /*------------------------------------------------------------------ */
 /*     Genetic Analysis of Complex Traits Using SAS    Chapter 2     */ 
 /*                      James D. Fry                                 */
 /*       Copyright(c) 2004 by SAS Institute Inc., Cary, NC, USA      */
 /*                   SAS Publications order # 59454                  */
 /*                        ISBN 1-59047-507-0                         */
 /*-------------------------------------------------------------------*/
 /*  History:  Created Oct 2004                                       */
 /*-------------------------------------------------------------------*/
 /*                                                                   */
 /* This material is provided "as is" by SAS Institute Inc.  There    */
 /* are no warranties, expressed or implied, as to merchantability or */
 /* fitness for a particular purpose regarding the materials or code  */
 /* contained herein. The Institute is not responsible for errors     */
 /* in this material as it now exists or will exist, nor does the     */
 /* Institute provide technical support for it.                       */
 /*                                                                   */
 /*-------------------------------------------------------------------*/


**** Datasets and programs for Chapter 2 ***;

data beetle;
input sire dam progeny value trait $;
datalines;
1	1	1	58	fec
1	1	1	4.6	mass
1	1	2	64	fec
1	1	2	4	mass
1	1	3	50	fec
1	1	3	4.1	mass
1	1	4	53	fec
1	1	4	4.2	mass
1	1	5	50	fec
1	1	5	4	mass
1	2	1	54	fec
1	2	1	4.7	mass
1	2	2	85	fec
1	2	2	5.7	mass
1	2	3	48	fec
1	2	3	3.6	mass
1	2	4	55	fec
1	2	4	4.9	mass
1	2	5	48	fec
1	2	5	3.3	mass
1	3	1	51	fec
1	3	1	5.1	mass
1	3	2	76	fec
1	3	2	5.2	mass
1	3	3	58	fec
1	3	3	5.6	mass
1	3	4	48	fec
1	3	4	3.6	mass
1	3	5	55	fec
1	3	5	3.5	mass
1	4	1	28	fec
1	4	1	5.1	mass
1	4	2	44	fec
1	4	2	5.6	mass
1	4	3	21	fec
1	4	3	4.3	mass
1	4	4	31	fec
1	4	4	4.4	mass
1	4	5	17	fec
1	4	5	4.2	mass
1	5	1	44	fec
1	5	1	4.1	mass
1	5	2	51	fec
1	5	2	4.4	mass
1	5	3	27	fec
1	5	3	4.1	mass
1	5	4	42	fec
1	5	4	3.5	mass
1	5	5	40	fec
1	5	5	3.7	mass
2	1	1	62	fec
2	1	1	4.7	mass
2	1	2	52	fec
2	1	2	4.3	mass
2	1	3	66	fec
2	1	3	5.2	mass
2	1	4	56	fec
2	1	4	4.6	mass
2	1	5	37	fec
2	1	5	3	mass
2	2	1	59	fec
2	2	1	4.5	mass
2	2	2	52	fec
2	2	2	4.7	mass
2	2	3	62	fec
2	2	3	4.9	mass
2	2	4	56	fec
2	2	4	4.2	mass
2	2	5	58	fec
2	2	5	5.5	mass
2	3	1	48	fec
2	3	1	5.3	mass
2	3	2	63	fec
2	3	2	5.7	mass
2	3	3	21	fec
2	3	3	4.2	mass
2	3	4	60	fec
2	3	4	4.4	mass
2	3	5	50	fec
2	3	5	3.9	mass
2	4	1	38	fec
2	4	1	4.4	mass
2	4	2	56	fec
2	4	2	4.3	mass
2	4	3	33	fec
2	4	3	4.8	mass
2	4	4	22	fec
2	4	4	4.5	mass
2	4	5	68	fec
2	4	5	4.9	mass
3	1	1	70	fec
3	1	1	5.5	mass
3	1	2	36	fec
3	1	2	4.1	mass
3	1	3	64	fec
3	1	3	4.9	mass
3	1	4	46	fec
3	1	4	4.8	mass
3	1	5	31	fec
3	1	5	4.2	mass
3	2	1	43	fec
3	2	1	5.7	mass
3	2	2	17	fec
3	2	2	5.2	mass
3	2	3	23	fec
3	2	3	4.9	mass
3	2	4	76	fec
3	2	4	5.6	mass
3	2	5	12	fec
3	2	5	4.7	mass
3	3	1	18	fec
3	3	1	4.1	mass
3	3	2	9	fec
3	3	2	4.9	mass
3	3	3	18	fec
3	3	3	3.8	mass
3	3	4	53	fec
3	3	4	4.2	mass
3	3	5	43	fec
3	3	5	4.5	mass
3	4	1	53	fec
3	4	1	4	mass
3	4	2	57	fec
3	4	2	5.1	mass
3	4	3	60	fec
3	4	3	4.2	mass
3	4	4	50	fec
3	4	4	5.1	mass
3	4	5	62	fec
3	4	5	5	mass
3	5	1	83	fec
3	5	1	6.4	mass
3	5	2	22	fec
3	5	2	4.8	mass
3	5	3	22	fec
3	5	3	5.3	mass
3	5	4	71	fec
3	5	4	4.6	mass
3	5	5	71	fec
3	5	5	5.3	mass
4	1	1	70	fec
4	1	1	4.8	mass
4	1	2	66	fec
4	1	2	5.5	mass
4	1	3	64	fec
4	1	3	5.1	mass
4	1	4	43	fec
4	1	4	3.9	mass
4	1	5	46	fec
4	1	5	3.5	mass
4	2	1	34	fec
4	2	1	4.3	mass
4	2	2	16	fec
4	2	2	4.6	mass
4	2	3	14	fec
4	2	3	4.3	mass
4	2	4	19	fec
4	2	4	4.1	mass
4	2	5	17	fec
4	2	5	4.5	mass
4	3	1	46	fec
4	3	1	5.3	mass
4	3	2	62	fec
4	3	2	5.4	mass
4	3	3	72	fec
4	3	3	5.4	mass
4	3	4	54	fec
4	3	4	5.1	mass
4	3	5	55	fec
4	3	5	4.9	mass
4	4	1	52	fec
4	4	1	4.3	mass
4	4	2	61	fec
4	4	2	4.6	mass
4	4	3	57	fec
4	4	3	4.2	mass
4	4	4	71	fec
4	4	4	4.9	mass
4	4	5	52	fec
4	4	5	4.6	mass
4	5	1	51	fec
4	5	1	4	mass
4	5	2	45	fec
4	5	2	4.1	mass
4	5	3	51	fec
4	5	3	4.5	mass
4	5	4	44	fec
4	5	4	4.6	mass
4	5	5	44	fec
4	5	5	4	mass
5	1	1	75	fec
5	1	1	5.1	mass
5	1	2	62	fec
5	1	2	5.4	mass
5	1	3	60	fec
5	1	3	5.2	mass
5	1	4	64	fec
5	1	4	4.8	mass
5	1	5	64	fec
5	1	5	5.1	mass
5	2	1	92	fec
5	2	1	5.6	mass
5	2	2	88	fec
5	2	2	5.5	mass
5	2	3	67	fec
5	2	3	5.5	mass
5	2	4	72	fec
5	2	4	5.5	mass
5	2	5	77	fec
5	2	5	5.4	mass
5	3	1	85	fec
5	3	1	5.7	mass
5	3	2	64	fec
5	3	2	4.9	mass
5	3	3	48	fec
5	3	3	4.5	mass
5	3	4	50	fec
5	3	4	4.1	mass
5	3	5	59	fec
5	3	5	5.1	mass
5	4	1	93	fec
5	4	1	5.1	mass
5	4	2	47	fec
5	4	2	4.7	mass
5	4	3	58	fec
5	4	3	4	mass
5	4	4	48	fec
5	4	4	3.8	mass
5	4	5	39	fec
5	4	5	3.6	mass
6	1	1	73	fec
6	1	1	4.1	mass
6	1	2	33	fec
6	1	2	3.3	mass
6	1	3	25	fec
6	1	3	4	mass
6	1	4	53	fec
6	1	4	4	mass
6	1	5	29	fec
6	1	5	3.9	mass
6	2	1	72	fec
6	2	1	5	mass
6	2	2	75	fec
6	2	2	5	mass
6	2	3	75	fec
6	2	3	4.6	mass
6	2	4	77	fec
6	2	4	5.5	mass
6	2	5	63	fec
6	2	5	4.8	mass
6	3	1	54	fec
6	3	1	3.9	mass
6	3	2	40	fec
6	3	2	3.1	mass
6	3	3	58	fec
6	3	3	4.2	mass
6	3	4	52	fec
6	3	4	4.4	mass
6	3	5	53	fec
6	3	5	4.1	mass
6	4	1	63	fec
6	4	1	5	mass
6	4	2	57	fec
6	4	2	3.8	mass
6	4	3	36	fec
6	4	3	3.2	mass
6	4	4	20	fec
6	4	4	4.3	mass
6	4	5	49	fec
6	4	5	4.9	mass
6	5	1	67	fec
6	5	1	4.4	mass
6	5	2	85	fec
6	5	2	5.8	mass
6	5	3	46	fec
6	5	3	4.7	mass
6	5	4	68	fec
6	5	4	4.8	mass
6	5	5	44	fec
6	5	5	5	mass
7	1	1	32	fec
7	1	1	5.3	mass
7	1	2	64	fec
7	1	2	4.7	mass
7	1	3	72	fec
7	1	3	5.7	mass
7	1	4	40	fec
7	1	4	3.9	mass
7	1	5	40	fec
7	1	5	5.4	mass
7	2	1	70	fec
7	2	1	5	mass
7	2	2	19	fec
7	2	2	4.9	mass
7	2	3	31	fec
7	2	3	4.1	mass
7	2	4	66	fec
7	2	4	5	mass
7	2	5	53	fec
7	2	5	5.3	mass
7	3	1	63	fec
7	3	1	4.7	mass
7	3	2	50	fec
7	3	2	4.8	mass
7	3	3	78	fec
7	3	3	5.2	mass
7	3	4	77	fec
7	3	4	6.3	mass
7	3	5	48	fec
7	3	5	4.3	mass
7	4	1	73	fec
7	4	1	5.4	mass
7	4	2	67	fec
7	4	2	4.9	mass
7	4	3	57	fec
7	4	3	4.2	mass
7	4	4	33	fec
7	4	4	5.1	mass
7	4	5	53	fec
7	4	5	4	mass
7	5	1	79	fec
7	5	1	5.3	mass
7	5	2	68	fec
7	5	2	4.8	mass
7	5	3	39	fec
7	5	3	4.6	mass
7	5	4	48	fec
7	5	4	4.8	mass
7	5	5	58	fec
7	5	5	5.1	mass
8	1	1	56	fec
8	1	1	4.6	mass
8	1	2	36	fec
8	1	2	3.3	mass
8	1	3	40	fec
8	1	3	4.1	mass
8	1	4	60	fec
8	1	4	4.6	mass
8	1	5	51	fec
8	1	5	3.8	mass
8	2	1	63	fec
8	2	1	4.3	mass
8	2	2	73	fec
8	2	2	4.7	mass
8	2	3	51	fec
8	2	3	3.8	mass
8	2	4	74	fec
8	2	4	4.8	mass
8	2	5	64	fec
8	2	5	4.5	mass
8	3	1	48	fec
8	3	1	4.2	mass
8	3	2	28	fec
8	3	2	4	mass
8	3	3	32	fec
8	3	3	3.6	mass
8	3	4	50	fec
8	3	4	4.1	mass
8	3	5	44	fec
8	3	5	3.4	mass
8	4	1	79	fec
8	4	1	4.6	mass
8	4	2	27	fec
8	4	2	2.4	mass
8	4	3	17	fec
8	4	3	4.4	mass
8	4	4	41	fec
8	4	4	4	mass
8	4	5	30	fec
8	4	5	5.7	mass
9	1	1	51	fec
9	1	1	3.3	mass
9	1	2	48	fec
9	1	2	4	mass
9	1	3	78	fec
9	1	3	5.2	mass
9	1	4	31	fec
9	1	4	3.9	mass
9	1	5	53	fec
9	1	5	3.7	mass
9	2	1	65	fec
9	2	1	3.8	mass
9	2	2	40	fec
9	2	2	3.5	mass
9	2	3	46	fec
9	2	3	4.1	mass
9	2	4	39	fec
9	2	4	4.7	mass
9	2	5	58	fec
9	2	5	3.9	mass
9	3	1	72	fec
9	3	1	4.4	mass
9	3	2	52	fec
9	3	2	3.7	mass
9	3	3	56	fec
9	3	3	3.7	mass
9	3	4	61	fec
9	3	4	3.9	mass
9	3	5	46	fec
9	3	5	3.3	mass
9	4	1	28	fec
9	4	1	4.3	mass
9	4	2	25	fec
9	4	2	4.4	mass
9	4	3	63	fec
9	4	3	4.2	mass
9	4	4	20	fec
9	4	4	4.9	mass
9	4	5	26	fec
9	4	5	4.2	mass
10	1	1	35	fec
10	1	1	4.1	mass
10	1	2	60	fec
10	1	2	4.6	mass
10	1	3	17	fec
10	1	3	4.4	mass
10	1	4	65	fec
10	1	4	4.5	mass
10	1	5	31	fec
10	1	5	4.6	mass
10	2	1	78	fec
10	2	1	4.7	mass
10	2	2	74	fec
10	2	2	4.9	mass
10	2	3	72	fec
10	2	3	5.3	mass
10	2	4	72	fec
10	2	4	5.1	mass
10	2	5	71	fec
10	2	5	6.4	mass
10	3	1	69	fec
10	3	1	4.5	mass
10	3	2	76	fec
10	3	2	5	mass
10	3	3	54	fec
10	3	3	4.5	mass
10	3	4	69	fec
10	3	4	5.2	mass
10	3	5	51	fec
10	3	5	4.8	mass
10	4	1	79	fec
10	4	1	5.5	mass
10	4	2	84	fec
10	4	2	5.3	mass
10	4	3	85	fec
10	4	3	5.2	mass
10	4	4	51	fec
10	4	4	6.2	mass
10	4	5	73	fec
10	4	5	6.8	mass
11	1	1	76	fec
11	1	1	4.3	mass
11	1	2	56	fec
11	1	2	4.4	mass
11	1	3	80	fec
11	1	3	4.6	mass
11	1	4	74	fec
11	1	4	5.2	mass
11	1	5	54	fec
11	1	5	4	mass
11	2	1	69	fec
11	2	1	4	mass
11	2	2	72	fec
11	2	2	4.6	mass
11	2	3	68	fec
11	2	3	4.4	mass
11	2	4	81	fec
11	2	4	4.7	mass
11	2	5	45	fec
11	2	5	3.6	mass
11	3	1	43	fec
11	3	1	3.8	mass
11	3	2	40	fec
11	3	2	3.6	mass
11	3	3	48	fec
11	3	3	4.4	mass
11	3	4	45	fec
11	3	4	3.4	mass
11	3	5	74	fec
11	3	5	5.3	mass
11	4	1	58	fec
11	4	1	4.1	mass
11	4	2	47	fec
11	4	2	3.8	mass
11	4	3	63	fec
11	4	3	4	mass
11	4	4	45	fec
11	4	4	3.2	mass
11	4	5	45	fec
11	4	5	5	mass
11	5	1	62	fec
11	5	1	4.8	mass
11	5	2	72	fec
11	5	2	4.1	mass
11	5	3	63	fec
11	5	3	5.1	mass
11	5	4	47	fec
11	5	4	3.8	mass
11	5	5	64	fec
11	5	5	6.1	mass
12	1	1	72	fec
12	1	1	6.3	mass
12	1	2	47	fec
12	1	2	4	mass
12	1	3	56	fec
12	1	3	4.9	mass
12	1	4	37	fec
12	1	4	4.5	mass
12	1	5	65	fec
12	1	5	4.8	mass
12	2	1	47	fec
12	2	1	5	mass
12	2	2	52	fec
12	2	2	4.9	mass
12	2	3	59	fec
12	2	3	5.4	mass
12	2	4	51	fec
12	2	4	4.6	mass
12	2	5	25	fec
12	2	5	3.8	mass
12	3	1	49	fec
12	3	1	5.2	mass
12	3	2	48	fec
12	3	2	4.7	mass
12	3	3	70	fec
12	3	3	4.8	mass
12	3	4	52	fec
12	3	4	4.4	mass
12	3	5	67	fec
12	3	5	5.4	mass
12	4	1	54	fec
12	4	1	5.6	mass
12	4	2	58	fec
12	4	2	4.6	mass
12	4	3	54	fec
12	4	3	4.7	mass
12	4	4	64	fec
12	4	4	5.3	mass
12	4	5	56	fec
12	4	5	5	mass
12	5	1	44	fec
12	5	1	4.9	mass
12	5	2	70	fec
12	5	2	5.6	mass
12	5	3	47	fec
12	5	3	4.4	mass
12	5	4	41	fec
12	5	4	3.9	mass
12	5	5	45	fec
12	5	5	5.3	mass
13	1	1	48	fec
13	1	1	3.7	mass
13	1	2	55	fec
13	1	2	3.5	mass
13	1	3	22	fec
13	1	3	4	mass
13	1	4	61	fec
13	1	4	3.8	mass
13	1	5	57	fec
13	1	5	4.1	mass
13	2	1	43	fec
13	2	1	4.7	mass
13	2	2	44	fec
13	2	2	3.7	mass
13	2	3	30	fec
13	2	3	3.9	mass
13	2	4	42	fec
13	2	4	2.8	mass
13	2	5	25	fec
13	2	5	4.1	mass
13	3	1	58	fec
13	3	1	4.1	mass
13	3	2	55	fec
13	3	2	4.3	mass
13	3	3	55	fec
13	3	3	4.6	mass
13	3	4	46	fec
13	3	4	4.6	mass
13	3	5	50	fec
13	3	5	4.6	mass
13	4	1	82	fec
13	4	1	5.3	mass
13	4	2	94	fec
13	4	2	4.8	mass
13	4	3	43	fec
13	4	3	5	mass
13	4	4	38	fec
13	4	4	5	mass
13	4	5	19	fec
13	4	5	4.2	mass
13	5	1	81	fec
13	5	1	4.4	mass
13	5	2	84	fec
13	5	2	4.7	mass
13	5	3	46	fec
13	5	3	3.7	mass
13	5	4	81	fec
13	5	4	4.5	mass
13	5	5	48	fec
13	5	5	4.2	mass
14	1	1	28	fec
14	1	1	5.7	mass
14	1	2	55	fec
14	1	2	5.8	mass
14	1	3	27	fec
14	1	3	5.3	mass
14	1	4	48	fec
14	1	4	4.3	mass
14	1	5	52	fec
14	1	5	5.2	mass
14	2	1	39	fec
14	2	1	3.9	mass
14	2	2	48	fec
14	2	2	4.7	mass
14	2	3	30	fec
14	2	3	5.5	mass
14	2	4	51	fec
14	2	4	4.8	mass
14	2	5	43	fec
14	2	5	4	mass
14	3	1	24	fec
14	3	1	4.4	mass
14	3	2	20	fec
14	3	2	4.8	mass
14	3	3	14	fec
14	3	3	4	mass
14	3	4	18	fec
14	3	4	3.8	mass
14	3	5	48	fec
14	3	5	3.9	mass
14	4	1	60	fec
14	4	1	4.5	mass
14	4	2	45	fec
14	4	2	4	mass
14	4	3	57	fec
14	4	3	5.5	mass
14	4	4	38	fec
14	4	4	4.9	mass
14	4	5	62	fec
14	4	5	5.1	mass
14	5	1	52	fec
14	5	1	4.5	mass
14	5	2	58	fec
14	5	2	4.5	mass
14	5	3	54	fec
14	5	3	5.6	mass
14	5	4	64	fec
14	5	4	5.1	mass
14	5	5	49	fec
14	5	5	4.5	mass
15	1	1	88	fec
15	1	1	5.2	mass
15	1	2	48	fec
15	1	2	4.4	mass
15	1	3	48	fec
15	1	3	3.6	mass
15	1	4	61	fec
15	1	4	4.7	mass
15	1	5	41	fec
15	1	5	3.9	mass
15	2	1	64	fec
15	2	1	4.3	mass
15	2	2	78	fec
15	2	2	5.5	mass
15	2	3	67	fec
15	2	3	4.5	mass
15	2	4	71	fec
15	2	4	5.1	mass
15	2	5	59	fec
15	2	5	4.5	mass
15	3	1	64	fec
15	3	1	5	mass
15	3	2	59	fec
15	3	2	4.9	mass
15	3	3	51	fec
15	3	3	5.3	mass
15	3	4	67	fec
15	3	4	4.8	mass
15	3	5	72	fec
15	3	5	6	mass
15	4	1	86	fec
15	4	1	4.9	mass
15	4	2	81	fec
15	4	2	5.9	mass
15	4	3	71	fec
15	4	3	6.1	mass
15	4	4	86	fec
15	4	4	5.6	mass
15	4	5	73	fec
15	4	5	4.8	mass
15	5	1	75	fec
15	5	1	6.3	mass
15	5	2	61	fec
15	5	2	5.6	mass
15	5	3	42	fec
15	5	3	5.1	mass
15	5	4	65	fec
15	5	4	5.3	mass
15	5	5	58	fec
15	5	5	4.9	mass
16	1	1	50	fec
16	1	1	4	mass
16	1	2	23	fec
16	1	2	4.5	mass
16	1	3	74	fec
16	1	3	5	mass
16	1	4	64	fec
16	1	4	4.3	mass
16	1	5	51	fec
16	1	5	4.3	mass
16	2	1	74	fec
16	2	1	5.3	mass
16	2	2	68	fec
16	2	2	4.7	mass
16	2	3	61	fec
16	2	3	3.8	mass
16	2	4	60	fec
16	2	4	4	mass
16	2	5	60	fec
16	2	5	4.3	mass
16	3	1	72	fec
16	3	1	4.8	mass
16	3	2	62	fec
16	3	2	4.5	mass
16	3	3	68	fec
16	3	3	4.4	mass
16	3	4	78	fec
16	3	4	5.2	mass
16	3	5	63	fec
16	3	5	4.7	mass
16	4	1	68	fec
16	4	1	3.9	mass
16	4	2	72	fec
16	4	2	4	mass
16	4	3	61	fec
16	4	3	3.5	mass
16	4	4	56	fec
16	4	4	4.1	mass
16	4	5	73	fec
16	4	5	4.8	mass
17	1	1	14	fec
17	1	1	3.7	mass
17	1	2	26	fec
17	1	2	4.9	mass
17	1	3	44	fec
17	1	3	3.4	mass
17	1	4	34	fec
17	1	4	3.9	mass
17	1	5	51	fec
17	1	5	4.4	mass
17	2	1	57	fec
17	2	1	4.3	mass
17	2	2	75	fec
17	2	2	6.6	mass
17	2	3	45	fec
17	2	3	3.3	mass
17	2	4	68	fec
17	2	4	5.6	mass
17	2	5	77	fec
17	2	5	5.2	mass
17	3	1	51	fec
17	3	1	5.1	mass
17	3	2	35	fec
17	3	2	5.4	mass
17	3	3	61	fec
17	3	3	5.3	mass
17	3	4	34	fec
17	3	4	5.4	mass
17	3	5	57	fec
17	3	5	4.7	mass
17	4	1	62	fec
17	4	1	5.2	mass
17	4	2	49	fec
17	4	2	3.8	mass
17	4	3	40	fec
17	4	3	4.9	mass
17	4	4	45	fec
17	4	4	4.9	mass
17	4	5	55	fec
17	4	5	4.6	mass
17	5	1	65	fec
17	5	1	4.7	mass
17	5	2	24	fec
17	5	2	3.4	mass
17	5	3	19	fec
17	5	3	4.8	mass
17	5	4	28	fec
17	5	4	3.6	mass
17	5	5	68	fec
17	5	5	4.7	mass
18	1	1	28	fec
18	1	1	3.8	mass
18	1	2	42	fec
18	1	2	3.3	mass
18	1	3	19	fec
18	1	3	3.4	mass
18	1	4	24	fec
18	1	4	5	mass
18	1	5	15	fec
18	1	5	2.7	mass
18	2	1	80	fec
18	2	1	5.7	mass
18	2	2	57	fec
18	2	2	3.8	mass
18	2	3	76	fec
18	2	3	4.7	mass
18	2	4	30	fec
18	2	4	4.7	mass
18	2	5	72	fec
18	2	5	5.6	mass
18	3	1	61	fec
18	3	1	4.1	mass
18	3	2	46	fec
18	3	2	3.6	mass
18	3	3	50	fec
18	3	3	4.1	mass
18	3	4	64	fec
18	3	4	3.8	mass
18	3	5	41	fec
18	3	5	4	mass
18	4	1	71	fec
18	4	1	4.3	mass
18	4	2	59	fec
18	4	2	4.8	mass
18	4	3	58	fec
18	4	3	4.1	mass
18	4	4	61	fec
18	4	4	4	mass
18	4	5	70	fec
18	4	5	4.6	mass
19	1	1	73	fec
19	1	1	5	mass
19	1	2	63	fec
19	1	2	4.2	mass
19	1	3	58	fec
19	1	3	4.1	mass
19	1	4	64	fec
19	1	4	4	mass
19	1	5	72	fec
19	1	5	5.2	mass
19	2	1	66	fec
19	2	1	4.4	mass
19	2	2	61	fec
19	2	2	3.5	mass
19	2	3	85	fec
19	2	3	4.2	mass
19	2	4	32	fec
19	2	4	4.6	mass
19	2	5	48	fec
19	2	5	4	mass
19	3	1	68	fec
19	3	1	4.7	mass
19	3	2	62	fec
19	3	2	4.4	mass
19	3	3	60	fec
19	3	3	3.8	mass
19	3	4	62	fec
19	3	4	5	mass
19	3	5	52	fec
19	3	5	4.4	mass
19	4	1	70	fec
19	4	1	4	mass
19	4	2	71	fec
19	4	2	4.9	mass
19	4	3	44	fec
19	4	3	3.6	mass
19	4	4	63	fec
19	4	4	4.4	mass
19	5	1	64	fec
19	5	1	4.6	mass
19	5	2	62	fec
19	5	2	4.4	mass
19	5	3	53	fec
19	5	3	4.9	mass
19	5	4	62	fec
19	5	4	4.4	mass
19	5	5	55	fec
19	5	5	4.5	mass
20	1	1	55	fec
20	1	1	4	mass
20	1	2	86	fec
20	1	2	7	mass
20	1	3	71	fec
20	1	3	4.5	mass
20	1	4	62	fec
20	1	4	5	mass
20	1	5	48	fec
20	1	5	4.8	mass
20	2	1	57	fec
20	2	1	4.6	mass
20	2	2	51	fec
20	2	2	4.4	mass
20	2	3	66	fec
20	2	3	4.8	mass
20	2	4	38	fec
20	2	4	4	mass
20	2	5	68	fec
20	2	5	5.5	mass
20	3	1	22	fec
20	3	1	4.6	mass
20	3	2	18	fec
20	3	2	5.9	mass
20	3	3	6	fec
20	3	3	5.5	mass
20	3	4	20	fec
20	3	4	4.2	mass
20	3	5	4	fec
20	3	5	4.5	mass
20	4	1	56	fec
20	4	1	3.9	mass
20	4	2	57	fec
20	4	2	4.9	mass
20	4	3	64	fec
20	4	3	5	mass
20	4	4	54	fec
20	4	4	4	mass
20	4	5	58	fec
20	4	5	4.8	mass
21	1	1	58	fec
21	1	1	4.1	mass
21	1	2	81	fec
21	1	2	5.7	mass
21	1	3	74	fec
21	1	3	5.3	mass
21	1	4	62	fec
21	1	4	4.1	mass
21	1	5	58	fec
21	1	5	4.7	mass
21	2	1	69	fec
21	2	1	4.9	mass
21	2	2	74	fec
21	2	2	6.2	mass
21	2	3	58	fec
21	2	3	5	mass
21	2	4	64	fec
21	2	4	4.5	mass
21	2	5	59	fec
21	2	5	5.5	mass
21	3	1	47	fec
21	3	1	4.9	mass
21	3	2	65	fec
21	3	2	5.2	mass
21	3	3	28	fec
21	3	3	5.1	mass
21	3	4	58	fec
21	3	4	4	mass
21	3	5	64	fec
21	3	5	4.5	mass
21	4	1	80	fec
21	4	1	4.7	mass
21	4	2	83	fec
21	4	2	4	mass
21	4	3	69	fec
21	4	3	4.8	mass
21	4	4	62	fec
21	4	4	5	mass
21	4	5	59	fec
21	4	5	5.3	mass
22	1	1	68	fec
22	1	1	4.5	mass
22	1	2	39	fec
22	1	2	5.2	mass
22	1	3	40	fec
22	1	3	4.8	mass
22	1	4	60	fec
22	1	4	4.7	mass
22	1	5	45	fec
22	1	5	3.7	mass
22	2	1	80	fec
22	2	1	5	mass
22	2	2	70	fec
22	2	2	5	mass
22	2	3	81	fec
22	2	3	5.2	mass
22	2	4	61	fec
22	2	4	5.2	mass
22	2	5	67	fec
22	2	5	4.9	mass
22	3	1	60	fec
22	3	1	5.8	mass
22	3	2	64	fec
22	3	2	5.3	mass
22	3	3	46	fec
22	3	3	4.4	mass
22	3	4	60	fec
22	3	4	5.7	mass
22	3	5	59	fec
22	3	5	4.8	mass
22	4	1	71	fec
22	4	1	5	mass
22	4	2	68	fec
22	4	2	5.2	mass
22	4	3	78	fec
22	4	3	5.4	mass
22	4	4	60	fec
22	4	4	4.4	mass
22	4	5	58	fec
22	4	5	5.6	mass
22	5	1	66	fec
22	5	1	5.1	mass
22	5	2	53	fec
22	5	2	4.1	mass
22	5	3	65	fec
22	5	3	5	mass
22	5	4	25	fec
22	5	4	4.5	mass
22	5	5	58	fec
22	5	5	4.8	mass
23	1	1	73	fec
23	1	1	5.1	mass
23	1	2	64	fec
23	1	2	5.7	mass
23	1	3	64	fec
23	1	3	6.1	mass
23	1	4	64	fec
23	1	4	6	mass
23	1	5	87	fec
23	1	5	7.2	mass
23	2	1	36	fec
23	2	1	4.9	mass
23	2	2	73	fec
23	2	2	6.1	mass
23	2	3	42	fec
23	2	3	3.6	mass
23	2	4	68	fec
23	2	4	5.3	mass
23	2	5	52	fec
23	2	5	5.2	mass
23	3	1	65	fec
23	3	1	4.9	mass
23	3	2	76	fec
23	3	2	4.6	mass
23	3	3	59	fec
23	3	3	5.1	mass
23	3	4	45	fec
23	3	4	4.6	mass
23	3	5	67	fec
23	3	5	5.3	mass
23	4	1	54	fec
23	4	1	5.6	mass
23	4	2	50	fec
23	4	2	3.6	mass
23	4	3	50	fec
23	4	3	4.8	mass
23	4	4	60	fec
23	4	4	3.9	mass
23	4	5	59	fec
23	4	5	5.2	mass
23	5	1	101	fec
23	5	1	6.3	mass
23	5	2	96	fec
23	5	2	5.2	mass
23	5	3	104	fec
23	5	3	5.1	mass
23	5	4	97	fec
23	5	4	5.7	mass
23	5	5	79	fec
23	5	5	5.5	mass
24	1	1	74	fec
24	1	1	4.3	mass
24	1	2	93	fec
24	1	2	5.2	mass
24	1	3	93	fec
24	1	3	5.5	mass
24	1	4	101	fec
24	1	4	5.9	mass
24	1	5	86	fec
24	1	5	5.1	mass
24	2	1	77	fec
24	2	1	5.3	mass
24	2	2	59	fec
24	2	2	3.4	mass
24	2	3	82	fec
24	2	3	5.4	mass
24	2	4	82	fec
24	2	4	5.1	mass
24	2	5	68	fec
24	2	5	5.1	mass
24	3	1	31	fec
24	3	1	4.7	mass
24	3	2	57	fec
24	3	2	5.6	mass
24	3	3	52	fec
24	3	3	6.5	mass
24	3	4	39	fec
24	3	4	4.6	mass
24	3	5	39	fec
24	3	5	5.4	mass
24	4	1	81	fec
24	4	1	4.9	mass
24	4	2	86	fec
24	4	2	4.8	mass
24	4	3	77	fec
24	4	3	4.3	mass
24	4	4	65	fec
24	4	4	3.9	mass
24	4	5	80	fec
24	4	5	4.6	mass
;

*** 2.2.1 base model ***;
proc mixed  data = beetle covtest asycov;
class sire dam;
where trait = 'fec';
model value = /solution;
random  sire dam(sire) / ;
run;


*** 2.2.1 likelihood ratio test for sire ***;
proc mixed  data = beetle covtest asycov;
class sire dam;
where trait = 'fec';
model value = ;
random   dam(sire) / ;
run;
data prob;
chiprob = 1 - probchi(4.6 , 1);
proc print;
run; 

*** 2.2.1 likelihood ratio test for maternal ***;
proc mixed data = beetle covtest;
class sire dam;
where trait = 'fec';
model value = ;
random sire dam(sire)/type = toep(1);
run; 
data prob;
chiprob = 1 - probchi(4.7 , 1);
proc print;
run; 


***  2.2.2 correlations between fecundity and body mass ***;
proc mixed data = beetle covtest asycov;
class sire dam progeny trait;
model value = trait;
random trait/subject = sire type = un;
random trait/subject = dam(sire) type = un;
repeated trait/subject = progeny(sire*dam) type = un;
run; 

*** 2.2.2 test if additive correlation=1 ***;
proc mixed data = beetle covtest asycov;
class sire dam progeny trait;
model value = trait;
random trait/subject = sire type = un;
random trait/subject = dam(sire) type = un;
repeated trait/subject = progeny(sire*dam) type = un;
parms 32 0.08 0.99999 114 1.4 0.08 177 3 0.3/hold = 3; 
run;
data prob;
chiprob = 1 - probchi(4.0 , 1);
proc print;
run; 


data mutants;
input treat $ line block relvia;
datalines;
lt	1	1	0.7136150235
r	1	1	0.6430868167
lt	1	1	0.7079646018
r	1	1	0.9377593361
lt	1	2	1.0454545455
r	1	2	0.6389776358
lt	1	2	0.7866666667
r	1	2	0.5972222222
lt	1	3	0.8275862069
r	1	3	0.914893617
lt	1	3	0.8192771084
r	1	3	0.9797297297
lt	10	1	0.8053097345
r	10	1	0.5722070845
lt	10	1	0.496
r	10	1	0.5825242718
lt	10	2	0.9243697479
r	10	2	0.7492260062
lt	10	2	0.7325581395
r	10	2	0.7884615385
lt	10	3	0.9937888199
r	10	3	0.5666666667
lt	10	3	0.8644067797
r	10	3	0.9056603774
lt	11	1	0.9032258065
r	11	1	0.7648902821
lt	11	1	0.5244755245
r	11	1	0.8646864686
lt	11	2	0.5622119816
r	11	2	0.5422535211
lt	11	2	1.1666666667
r	11	2	0.8361204013
lt	11	3	0.8292682927
r	11	3	0.7333333333
lt	11	3	1.0152284264
r	11	3	0.8784313725
lt	12	1	0.5940594059
r	12	1	0.472972973
lt	12	1	0.75
r	12	1	0.7816091954
lt	12	2	0.6715328467
r	12	2	0.6718146718
lt	12	2	0.6524064171
r	12	2	0.9297658863
lt	12	3	0.7407407407
r	12	3	0.9151291513
lt	12	3	0.6639344262
r	12	3	0.6505190311
lt	13	1	0.7262569832
r	13	1	0.7236467236
lt	13	1	0.6992481203
r	13	1	0.701754386
lt	13	2	0.5090909091
r	13	2	0.5906432749
lt	13	2	0.6467065868
r	13	2	0.7443609023
lt	13	3	0.8452380952
r	13	3	0.9035087719
lt	13	3	0.652014652
r	13	3	0.7692307692
lt	14	1	1.0355329949
r	14	1	0.8438538206
lt	14	1	0.7381974249
r	14	1	0.9520295203
lt	14	2	0.9384615385
r	14	2	0.7466666667
lt	14	2	0.8586956522
r	14	2	0.8612099644
lt	14	3	0.5562130178
r	14	3	0.9765258216
lt	14	3	0.862745098
r	14	3	0.8093645485
lt	15	1	0.6194690265
r	15	1	0.8025889968
lt	15	1	0.8294930876
r	15	1	0.7773279352
lt	15	2	0.9384615385
r	15	2	0.5732899023
lt	15	2	0.9718309859
r	15	2	0.5833333333
lt	15	3	0.7700534759
r	15	3	0.7294117647
lt	15	3	0.8340425532
r	15	3	0.8056537102
lt	16	1	0.9178743961
r	16	1	0.6898550725
lt	16	1	0.7578947368
r	16	1	0.9793103448
lt	16	2	0.7539267016
r	16	2	0.4649859944
lt	16	2	0.5837320574
r	16	2	0.5149051491
lt	16	3	0.6604651163
r	16	3	0.7586206897
lt	16	3	0.6071428571
r	16	3	0.9738562092
lt	17	1	0.8481675393
r	17	1	0.5517241379
lt	17	1	0.942408377
r	17	1	1.0878661088
lt	17	2	1.0434782609
r	17	2	0.6862170088
lt	17	2	0.8456375839
r	17	2	0.6824324324
lt	17	3	0.8055555556
r	17	3	0.9623430962
lt	17	3	1.0930232558
r	17	3	0.8976377953
lt	19	1	0.7368421053
r	19	1	0.7622641509
lt	19	1	0.678111588
r	19	1	0.6937269373
lt	19	2	1.156626506
r	19	2	0.8609271523
lt	19	2	0.7257383966
r	19	2	0.8
lt	19	3	0.9811320755
lt	19	3	0.6808510638
r	19	3	0.8642857143
lt	2	1	0.708994709
r	2	1	0.7072243346
lt	2	1	0.6393442623
r	2	1	0.7984790875
lt	2	2	0.9523809524
r	2	2	0.95
lt	2	2	1.2213740458
r	2	2	0.798679868
lt	2	3	0.7916666667
r	2	3	1.0197628458
lt	2	3	0.798206278
r	2	3	0.9133333333
lt	22	1	0.8071748879
lt	22	1	0.70781893
r	22	1	0.8482490272
lt	22	2	1.056768559
r	22	2	0.7003154574
lt	22	2	0.9444444444
r	22	2	0.7254237288
lt	22	3	0.7619047619
r	22	3	0.7724137931
lt	22	3	0.97
r	22	3	0.7797833935
lt	23	1	0.7272727273
r	23	1	0.8
lt	23	1	0.8355555556
r	23	1	1.0526315789
lt	23	2	0.8
r	23	2	0.8504983389
lt	23	2	0.7816091954
r	23	2	0.7697841727
lt	23	3	0.5
r	23	3	0.7482993197
lt	23	3	0.5638297872
r	23	3	0.8913043478
lt	24	1	1.0097087379
r	24	1	0.820083682
lt	24	1	0.6359447005
r	24	1	0.9247311828
lt	24	2	0.674556213
r	24	2	0.821656051
lt	24	2	0.649122807
r	24	2	0.582781457
lt	24	3	0.5753424658
r	24	3	0.5476190476
lt	24	3	0.6587301587
r	24	3	0.9312977099
lt	25	1	0.824742268
r	25	1	0.8902821317
lt	25	1	0.7767857143
r	25	1	0.6079027356
lt	25	2	0.9798657718
r	25	2	0.8657718121
lt	25	2	0.7375
r	25	2	0.7595818815
lt	25	3	0.5906040268
r	25	3	0.6764705882
lt	25	3	0.8356807512
r	25	3	0.8032128514
lt	26	1	0.9603960396
r	26	1	0.8133333333
lt	26	1	0.6271186441
r	26	1	0.7459807074
lt	26	2	0.9358974359
r	26	2	0.925795053
lt	26	2	0.6117647059
r	26	2	0.7242524917
lt	26	3	0.8305084746
r	26	3	0.7224334601
lt	26	3	0.9480519481
r	26	3	0.9098360656
lt	27	1	1.0769230769
r	27	1	0.9865771812
lt	27	1	0.618556701
r	27	1	1.0476190476
lt	27	2	0.8915662651
r	27	2	0.7896440129
lt	27	2	0.5989847716
r	27	2	0.5836298932
lt	27	3	0.875
r	27	3	0.7516778523
lt	27	3	0.9375
r	27	3	1.0364963504
lt	28	1	0.8023952096
r	28	1	0.7739726027
lt	28	1	0.9176470588
r	28	1	0.6864864865
lt	28	2	1.0857142857
r	28	2	0.9084745763
lt	28	2	1.2830188679
r	28	2	0.5696594427
lt	28	3	0.8862275449
r	28	3	0.864
lt	28	3	0.9447852761
r	28	3	0.7707006369
lt	29	1	0.908045977
r	29	1	0.7167235495
lt	29	1	0.6743295019
r	29	1	0.6892307692
lt	29	2	1.16
r	29	2	0.6472491909
lt	29	2	0.8695652174
r	29	2	0.4934210526
lt	29	3	1
r	29	3	0.9075630252
lt	29	3	0.901734104
r	29	3	0.9249011858
lt	3	1	0.7748691099
r	3	1	0.7619047619
lt	3	1	0.6613545817
r	3	1	0.7164179104
lt	3	2	1.0303030303
r	3	2	0.4197530864
lt	3	2	0.6064516129
r	3	2	0.6488294314
lt	3	3	0.5222929936
r	3	3	0.6006389776
lt	3	3	0.6390977444
r	3	3	0.6710526316
lt	30	1	0.5521885522
r	30	1	0.7207207207
lt	30	1	0.5770750988
r	30	1	0.7731629393
lt	30	2	0.7727272727
r	30	2	0.5507246377
lt	30	2	0.5882352941
r	30	2	0.5393939394
lt	30	3	1.1029411765
r	30	3	0.7125
lt	30	3	0.7106598985
r	30	3	0.8148148148
lt	31	1	0.5588235294
r	31	1	0.695035461
lt	31	1	0.6161137441
r	31	1	0.9128919861
lt	31	2	1.1223021583
r	31	2	0.5
lt	31	2	0.8947368421
r	31	2	0.5620915033
lt	31	3	1.0579710145
r	31	3	0.4984984985
lt	31	3	1.064516129
r	31	3	0.8172043011
lt	32	1	1.0107526882
r	32	1	0.9010238908
lt	32	1	0.8756218905
r	32	1	0.9187279152
lt	32	2	0.7787610619
lt	32	2	0.8592592593
r	32	2	0.8345323741
lt	32	3	0.8217054264
lt	32	3	0.9504132231
r	32	3	0.9256756757
lt	33	1	0.9763779528
r	33	1	0.7254237288
lt	33	1	0.7490039841
r	33	1	0.75
lt	33	2	1.28
r	33	2	0.7875
lt	33	2	0.6603773585
r	33	2	0.6095238095
lt	33	3	1.0281690141
r	33	3	0.8581314879
lt	33	3	0.7941176471
r	33	3	0.9328063241
lt	35	1	0.8596491228
r	35	1	0.8833922261
lt	35	1	1.0877192982
r	35	1	0.8040540541
lt	35	2	1
r	35	2	0.7448275862
lt	35	2	0.8021978022
r	35	2	0.8028673835
lt	35	3	1.0193548387
r	35	3	0.8549019608
lt	35	3	0.6596858639
r	35	3	0.8085106383
lt	37	1	0.6816479401
r	37	1	0.7627627628
lt	37	1	0.7168141593
r	37	1	0.9645390071
lt	37	2	0.9333333333
r	37	2	0.8843537415
lt	37	2	0.7282608696
r	37	2	0.6375838926
lt	37	3	0.964028777
r	37	3	0.7114624506
lt	37	3	0.6844444444
r	37	3	0.8428571429
lt	38	1	0.5562913907
r	38	1	0.8058608059
lt	38	1	0.880952381
r	38	1	0.80625
lt	38	2	1.0852713178
r	38	2	0.7784431138
lt	38	2	0.7928994083
r	38	2	0.8745980707
lt	38	3	0.7469879518
r	38	3	0.8024316109
lt	38	3	0.8235294118
r	38	3	0.9358974359
lt	41	1	0.4769874477
r	41	1	0.6713286713
lt	41	1	0.5581395349
r	41	1	0.7737226277
lt	41	2	1.0508474576
r	41	2	0.656
lt	41	2	0.5365853659
r	41	2	0.9527272727
lt	41	3	0.6153846154
r	41	3	0.7096774194
lt	41	3	0.5
r	41	3	0.6687116564
lt	42	1	0.6013071895
r	42	1	0.8913043478
lt	42	1	0.4304635762
r	42	1	0.6666666667
lt	42	2	0.4279069767
r	42	2	0.6430868167
lt	42	2	0.4064171123
r	42	2	0.4465408805
lt	42	3	0.5
r	42	3	0.2756183746
lt	42	3	0.4124513619
r	42	3	0.6456140351
lt	43	1	0.8586387435
r	43	1	0.7554179567
lt	43	1	0.5505226481
r	43	1	0.76816609
lt	43	2	0.7684210526
r	43	2	0.8592057762
lt	43	2	0.691943128
r	43	2	0.4329268293
lt	43	3	0.7231638418
r	43	3	0.6363636364
r	43	3	0.6293706294
lt	46	1	0.9745762712
r	46	1	0.6903914591
lt	46	1	1.1497584541
r	46	1	0.7160493827
lt	46	2	0.7857142857
r	46	2	0.8971962617
lt	46	2	0.9132947977
r	46	2	0.4459459459
lt	46	3	0.9645390071
r	46	3	0.7625899281
lt	46	3	1.097826087
r	46	3	0.824
lt	5	1	0.6172839506
r	5	1	0.4242424242
lt	5	1	0.7981220657
r	5	1	0.6319218241
lt	5	2	0.4927536232
r	5	2	0.4892966361
lt	5	2	0.4489795918
r	5	2	0.3675675676
lt	5	3	0.8111111111
r	5	3	0.5625
lt	5	3	0.7661691542
r	5	3	0.8150943396
lt	6	1	0.4861111111
r	6	1	0.7912087912
lt	6	1	0.7330677291
r	6	1	0.7070063694
lt	6	2	0.7808219178
r	6	2	0.6626506024
lt	6	2	0.6551724138
r	6	2	0.7588235294
lt	6	3	1.0212765957
r	6	3	0.8797250859
lt	6	3	0.7878787879
r	6	3	0.8185053381
lt	7	1	1.4526315789
r	7	1	1.0731707317
lt	7	1	0.8341232227
r	7	1	1.0426229508
lt	7	2	0.6296296296
r	7	2	0.5978647687
lt	7	2	0.8055555556
r	7	2	0.5418326693
lt	7	3	0.8441558442
r	7	3	0.9030100334
lt	7	3	0.6987951807
r	7	3	0.962406015
lt	9	1	0.7478991597
r	9	1	0.6064981949
lt	9	1	0.8157894737
r	9	1	0.833976834
lt	9	2	0.9152542373
r	9	2	0.7576791809
lt	9	2	0.6704545455
r	9	2	0.9078498294
lt	9	3	0.4805194805
r	9	3	0.6868131868
lt	9	3	0.8945147679
r	9	3	0.9743589744
; 

*** 2.2.3 base model ***;
proc mixed covtest data = mutants;
class treat block line;
model relvia = treat;	  
random block line treat*block block*line treat*line treat*block*line;
run; 

*** 2.2.3 unequal variances between environments ***;
proc mixed covtest data = mutants;
class treat block line;
model relvia = treat;
random treat/subject = line type = unr;
random block treat*block block*line;
repeated/group = treat;
run;
data prob;
chiprob = 1 - probchi(15 , 2);
proc print;
run; 

*** 2.2.3 test if among lines variances are equal ***;
proc mixed covtest data = mutants;
class treat block line;
model relvia = treat;
random treat/subject = line type = cs;
random block treat*block block*line;
repeated/group = treat;
run;
data prob;
chiprob = 1 - probchi(2.5 , 1);
proc print;
run; 


*** 2.2.3 test if within lines variances are equal ***;
proc mixed covtest data = mutants;
class treat block line;
model relvia = treat;
random treat/subject = line type = unr;
random block treat*block block*line;
*repeated/group = treat;
run;
data prob;
chiprob = 1 - probchi(9.9 , 1);
proc print;
run; 



data diallel;
input sire dam sqrnumb;
datalines;
1	2	10.9545
1	2	12.49
1	2	6.6332
1	2	13.9642
1	2	16.9115
1	2	15.5563
1	2	13.8203
1	2	14.3178
1	2	11.7898
1	3	10.6771
1	3	8.8318
1	3	5.4772
1	3	6.9282
1	3	5.5678
1	3	11.1355
1	3	10.6301
1	3	11.2694
1	3	11.8743
1	4	9.2736
1	4	10.3923
1	4	11.4018
1	4	12.0416
1	4	8.8882
1	4	9.9499
1	4	11.0454
1	4	13.9642
1	4	16.2481
1	4	16.5831
1	5	11.0454
1	5	15.8745
1	5	12.7671
1	5	11.225
1	5	13.6382
1	5	14.3178
1	5	15.2315
1	5	8.3066
1	5	10
1	5	10.9545
1	6	10.6771
1	6	13.1149
1	6	12.2474
1	6	14.3178
1	6	17.6352
1	6	12.7671
1	6	14
1	6	12.53
1	6	13.3417
1	6	16.5831
1	7	8.2462
1	7	9.7468
1	7	7.4162
1	7	7.9373
1	8	15
1	8	7.4833
1	8	6.7082
1	8	11
1	8	15.3297
1	8	12.6491
1	9	11.7898
1	9	17.5499
1	9	10.3441
1	9	14.7986
1	9	10.0995
1	9	14
1	9	9.1652
1	9	15.5242
1	9	13.1149
1	10	9.8995
1	10	10.198
1	10	13.7113
1	10	12.6491
1	10	10.7238
1	10	17.2337
1	10	13.6748
1	10	8.4853
2	1	14.9666
2	1	14.6287
2	1	18.3576
2	1	12.6095
2	1	13.8924
2	1	12.4499
2	1	10.5357
2	1	14.0357
2	1	12.53
2	1	14.3527
2	3	10.583
2	3	16.0935
2	3	6.5574
2	3	13.6015
2	3	11
2	3	11.2694
2	3	10.7238
2	4	9.5917
2	4	14.2829
2	4	10.6301
2	4	15.3297
2	4	10.9087
2	4	11.619
2	4	9.7468
2	4	13.5277
2	4	13.0767
2	4	15.9687
2	5	10.7238
2	5	15.0665
2	5	10.5357
2	5	10.8628
2	5	9.6437
2	5	12.8452
2	5	13.0384
2	5	13.7477
2	5	16.3401
2	6	12.083
2	6	12.9228
2	6	14
2	6	12.083
2	6	12.8841
2	6	9.3274
2	6	9.434
2	6	14.3527
2	7	11.0905
2	7	17.4356
2	7	11.3578
2	7	9.3808
2	7	6.7082
2	7	10.0995
2	7	9.6437
2	7	15.5885
2	7	12.4
2	7	11.1803
2	8	11.1355
2	8	8.9443
2	8	10.9545
2	8	10.0995
2	8	11.2694
2	8	9.2736
2	8	9.8995
2	9	11.9583
2	9	12
2	9	15.0997
2	9	13.2288
2	9	10.2956
2	9	15.0333
2	9	15.3297
2	10	14.1067
2	10	11.225
2	10	13.7113
2	10	13.784
2	10	10.8167
2	10	10.4881
2	10	11.0454
2	10	11.1803
2	10	12.6095
2	10	14.7986
3	1	12.3288
3	1	9.5917
3	1	11.4891
3	1	11.2694
3	1	12.2066
3	2	12.6491
3	2	13.784
3	2	10.583
3	2	9.0554
3	2	13.2665
3	2	10.0995
3	2	9.3274
3	2	10.5357
3	2	9.434
3	4	9.7468
3	4	9.1652
3	4	9.8489
3	4	12.5698
3	4	8.2462
3	4	11.619
3	4	11.225
3	4	7.746
3	5	12.0416
3	5	8.7178
3	5	15.5563
3	5	13.7477
3	6	12.7671
3	6	6.4807
3	6	5.831
3	6	12.3693
3	6	7.746
3	6	13.0767
3	7	10.4403
3	7	11.5758
3	7	10.4403
3	7	10.5
3	7	10.9545
3	7	12.4097
3	7	14.7309
3	7	9.6437
3	8	8.124
3	8	10.2956
3	8	9.2736
3	8	7.8102
3	9	13.0384
3	9	10.0995
3	9	12.4499
3	9	11.3578
3	9	13.9642
3	9	8.2462
3	9	11.3137
3	9	9.5917
3	9	12.5698
3	9	14.8997
3	10	9.5917
3	10	12.0416
3	10	12.6886
3	10	8.8882
3	10	9.4868
3	10	11.7898
3	10	10.2956
4	1	11.0454
4	1	14.0712
4	1	12.7279
4	1	6.4031
4	1	9.1
4	2	10.3923
4	2	9.4868
4	2	9.6437
4	2	11.1803
4	3	11
4	3	10.0499
4	3	10.6301
4	3	9.3274
4	3	11.0905
4	3	10.247
4	5	13.3791
4	5	14.1774
4	5	11.619
4	5	10.7238
4	5	14.7986
4	5	11.4018
4	5	10.247
4	6	9.3274
4	6	11
4	6	9.0554
4	6	16.5831
4	6	13.8203
4	6	11.5326
4	6	10.8628
4	6	9.7468
4	6	14.4568
4	7	8.8318
4	7	9.434
4	7	8.544
4	7	6.0828
4	7	10.0499
4	8	7.4833
4	8	8.6023
4	8	16.3707
4	8	9.2195
4	9	10.7703
4	9	8.8318
4	9	13.4164
4	9	9.4868
4	9	9.3274
4	9	9.6437
4	9	16.5227
4	10	15.3948
4	10	12.4499
4	10	10.9545
4	10	10.247
5	1	17.0587
5	1	10.3923
5	1	7.9373
5	1	10.583
5	1	11.3137
5	1	9.8995
5	1	11.4018
5	1	9.1104
5	1	11.0905
5	2	11
5	2	11.6619
5	2	6.7823
5	2	14.8997
5	2	14.3527
5	2	9.3808
5	2	15.4596
5	2	10.583
5	2	14.5602
5	2	10.8167
5	3	13.4164
5	3	9.7468
5	3	11.4455
5	3	10.198
5	3	14.5945
5	3	14.6969
5	4	11.3137
5	4	7.1414
5	4	7.874
5	4	12.8841
5	4	10.1489
5	4	11.9164
5	4	11.6619
5	4	7.874
5	6	11.619
5	6	13.0384
5	6	10.4881
5	6	11.3137
5	6	9.3808
5	6	13.2288
5	6	9.4868
5	6	9.3808
5	6	10.4403
5	6	16.6433
5	7	11.3137
5	7	9.2736
5	7	11.8322
5	7	13.7113
5	7	10.4881
5	7	14.1774
5	8	10.3923
5	8	7.9373
5	8	9.3274
5	8	11.5758
5	8	11.1355
5	8	9.8995
5	8	7.3485
5	8	11.0905
5	8	11.5758
5	9	14.7986
5	9	11.1355
5	9	13.6382
5	9	16.9706
5	9	14.1421
5	9	11.6619
5	9	17.2047
5	9	12.4097
5	9	8.0623
5	9	14.5602
5	10	9.3274
5	10	10.2956
5	10	14.2127
5	10	17.1464
5	10	8.775
5	10	10.0995
5	10	14.8324
5	10	9.8995
5	10	8.3066
6	1	10.4403
6	1	11.4455
6	1	11.8322
6	1	14.2478
6	1	14.0712
6	1	12.083
6	1	12.0416
6	1	13.8924
6	1	12.0416
6	2	11.3137
6	2	6
6	2	11.4891
6	2	9.0554
6	2	10.4403
6	2	12.0416
6	2	12.1244
6	2	11.7473
6	3	12.4097
6	3	11.4891
6	3	8.7178
6	3	15.906
6	3	14.4222
6	3	17.0587
6	3	12.49
6	3	11.5326
6	3	8.1854
6	4	11.4018
6	4	11.4018
6	4	11.4018
6	4	11.4018
6	5	15.906
6	5	16
6	5	11.4891
6	5	11.4018
6	5	12.49
6	5	12.7279
6	5	10.583
6	5	14.1421
6	5	13.2665
6	5	11.7898
6	7	16.2788
6	7	10.247
6	7	7.746
6	7	11.9583
6	7	8.2462
6	7	11.0905
6	8	11.4018
6	8	9.8995
6	8	9.434
6	9	11.4891
6	9	10.0995
6	9	8.8318
6	9	10.1489
6	9	17.1464
6	9	16.8226
6	9	17.5214
6	9	12.9228
6	9	14.4914
6	9	6.4807
6	10	12.9228
6	10	8.8318
6	10	10.583
6	10	16.1245
6	10	12.49
6	10	17.0294
6	10	6.8557
6	10	9.6954
7	1	12.53
7	1	13.0767
7	1	10.583
7	1	8.8318
7	2	11.6619
7	2	17.3781
7	2	12.5698
7	2	14.6629
7	2	13.8564
7	2	16.4012
7	2	11.5326
7	2	12.7279
7	2	16.0312
7	3	10.0499
7	3	15.4919
7	3	11.4891
7	3	10.7238
7	3	10.583
7	3	14.4568
7	3	10.1489
7	3	14.8997
7	4	9.9499
7	4	14.9332
7	4	10.9545
7	4	14.4568
7	4	11.7473
7	4	14.6969
7	4	12.4499
7	4	13.784
7	4	10.4403
7	5	8.2462
7	5	7.0711
7	5	8.775
7	5	15.5885
7	5	7.4162
7	5	15.6205
7	5	11.8743
7	5	11.4018
7	5	14.4222
7	6	9.434
7	6	13.6748
7	6	8.7178
7	6	8.1854
7	8	9.3808
7	8	8.3066
7	8	9.434
7	8	12.7279
7	8	10.4403
7	9	12.6095
7	9	12.6095
7	9	12.6095
7	9	12.6095
7	10	15.2315
7	10	11.1803
7	10	12.9615
7	10	15.8114
8	1	10
8	1	8.4261
8	1	10.6301
8	1	8.1854
8	1	10.8628
8	2	9.5917
8	2	9.5394
8	2	9.3808
8	2	8.6603
8	2	12.5698
8	2	11.0905
8	2	9.4868
8	2	9.7468
8	2	9.2736
8	3	8.7178
8	3	10.198
8	3	13
8	3	6.5574
8	3	9
8	3	15.2315
8	3	6
8	3	8.3666
8	4	11.1803
8	4	9.434
8	4	7.746
8	4	8.0623
8	4	6.3246
8	4	5.3852
8	4	8.6023
8	5	10.4403
8	5	8.544
8	5	9.6437
8	5	11.5326
8	5	8.6023
8	5	10.0995
8	6	8.0623
8	6	12.3288
8	6	9.0554
8	6	8.124
8	6	10.7703
8	6	10.0995
8	6	12.0416
8	6	10.7238
8	6	10.0995
8	6	10.8167
8	7	8.775
8	7	12.6491
8	7	7.3485
8	7	8.4261
8	7	8.2462
8	9	9.434
8	9	14.6629
8	9	11.2694
8	9	11.7473
8	9	10.3441
8	9	9.7468
8	9	11.5326
8	9	11.0454
8	9	11.0905
8	10	13.3041
8	10	13.2288
8	10	9.9499
8	10	7.4162
8	10	10.4403
8	10	9.2736
8	10	6.3246
8	10	9.9499
8	10	8.544
9	1	13.6015
9	1	5.831
9	1	10.8167
9	1	6.4807
9	2	10.1489
9	2	9.3274
9	2	15.4919
9	2	8.9443
9	2	13.4536
9	2	9.9499
9	2	16.7631
9	2	10.8167
9	3	11.6619
9	3	9.1104
9	3	7.8102
9	3	13.1529
9	3	11.7473
9	3	13.4536
9	3	15.6205
9	4	7.2111
9	4	10.198
9	4	8.4853
9	4	10.0499
9	4	12.8452
9	4	15.2315
9	4	8.544
9	4	12.2066
9	5	12.9615
9	5	15.5563
9	5	7.3485
9	5	16.6733
9	5	13.7113
9	5	13.6015
9	5	10.7703
9	5	11.4891
9	5	14.3527
9	5	11.5758
9	6	11.3137
9	6	11.3137
9	6	12.9228
9	6	16.5529
9	6	12.7671
9	6	16.1864
9	6	12.0416
9	6	15.8745
9	6	15.1987
9	6	14.1421
9	7	12.1244
9	7	13.9284
9	7	17.6635
9	7	13.3791
9	7	13.7477
9	7	11.2694
9	7	9.2736
9	7	15.1658
9	7	15.3623
9	8	6.1644
9	8	8.4261
9	8	14.2127
9	8	9.2195
9	8	7.9373
9	8	8.3666
9	8	12.1655
9	8	8.8318
9	10	8.4853
9	10	15.0997
9	10	13.4907
9	10	10.5357
9	10	6.3246
9	10	9.434
9	10	10.9087
9	10	10.8628
9	10	17.9722
10	1	12.083
10	1	12.0416
10	1	15.3297
10	1	15.1658
10	1	17.72
10	1	14.5602
10	1	9.5394
10	1	8.775
10	1	17.1172
10	2	10.583
10	2	11.5326
10	2	16.7631
10	2	10.7238
10	2	15.4919
10	2	9.5917
10	2	10.7238
10	2	13.2288
10	2	13.2288
10	3	12.9228
10	3	12.3288
10	3	10.3441
10	3	13.2665
10	3	15.0997
10	3	12.083
10	3	9.434
10	3	15.906
10	4	13.1149
10	4	8.775
10	4	11.5326
10	4	7.4833
10	4	19.8746
10	5	14.6629
10	5	13.2665
10	5	6.8557
10	5	13.4907
10	5	14.1421
10	6	11.7047
10	6	7.4833
10	6	7.9373
10	6	8.8318
10	6	13.6015
10	6	9.6437
10	6	9.7468
10	7	10.4403
10	7	10.8628
10	7	11.619
10	7	15.9687
10	8	11.4018
10	8	10.54
10	8	11.31
10	8	10.46
10	9	13.3791
10	9	10.583
10	9	14.2478
10	9	17.7482
10	9	9.8489
10	9	14.8997
10	9	11.619
10	9	8.4853
10	9	10.9545
10	9	8.1854
;

*** 2.3.1 create variance structure file ***;
data dummy;
 do row = 1 to 90;
  output;
   end;

 data fam1;
  do sire1 = 1 to 10;
   do dam1 = 1 to 10;
    output;
	 end;
	  end;

data fam1;
 set fam1;
  if sire1 = dam1 then delete;

data fam1;
 merge dummy fam1;
  
 data fam1;
  set fam1;
   do sire2 = 1 to 10;
    do dam2 = 1 to 10;
	 output;
	  end;
	   end;

data fam1;
 set fam1;
  if sire2 = dam2 then delete;

data dummy;
set dummy;
 do col = 1 to 90;
  output;
   end;

data ii;
 merge fam1 dummy;
 if row < col then delete;
  if sire1 = dam1 or sire2 = dam2 or
	(sire1 ^= sire2 and dam1 ^= dam2 and 
	sire1 ^= dam2 and dam1 ^= sire2)
	 then delete;
if sire1 = sire2 and dam1 = dam2 then rel = 'fulls';
 else if sire1 = dam2 and dam1 = sire2 then rel = 'rfs';
 else if sire1 = sire2 and dam1 ^= dam2 then rel = 'phs';
 else if sire1 ^= sire2 and dam1 = dam2 then rel = 'mhs';
 else rel = 'rhs';
   do parm = 1 to 5;
    output;
	 end;
  
 data ii;
  set ii;
   if parm = 1 then do;   
     if rel = 'fulls' or rel = 'rfs' then value = 2;
     else value = 1;
	 end;
   if parm = 2 then do;   
     if rel = 'fulls' or rel = 'rfs' then value = 1;
     else delete;
	 end;
 
   if parm = 3 then do;   
     if rel = 'fulls' or rel = 'mhs' then value = 1;
	else delete;
	 end;
   if parm = 4 then do;   
     if rel = 'fulls' or rel = 'phs' then value = 1;
	else delete;
	 end;
   if parm = 5 then do;   
     if rel = 'fulls' then value = 1;
	else delete;
	 end;
   keep parm row col value;
run;

*** 2.3.1  base model ***;
proc mixed data = diallel covtest asycov;
class dam sire ;
model sqrnumb = /solution;
random sire*dam/ type = lin(5) ldata = ii;
parms/ lowerb = 0,0,0,0,0,0;
run;


*** 2.3.1  test Var(n)=0 ***;
proc mixed data = diallel covtest asycov;
class dam sire ;
model sqrnumb = /solution;
random sire*dam/ type = lin(5) ldata = ii;
parms 0,0,0.04,0,0.3,6/ lowerb = 0,0,0,0,0,0 hold = 1,2,4;
run;
data prob;
chiprob = 1 - probchi(14.5 , 1);
proc print;
run;


